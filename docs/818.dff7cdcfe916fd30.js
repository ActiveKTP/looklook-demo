"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[818],{9818:(J,h,l)=>{l.r(h),l.d(h,{CategoryModule:()=>q});var d=l(177),t=l(4438),b=l(1626);let y=(()=>{class i{http;apiUrl="https://preview.keenthemes.com/starterkit/metronic/laravel/api/v1/roles";constructor(e){this.http=e}getUsers(e,n){return this.http.post(`${this.apiUrl}/${e}/users`,n)}getCategories(e){return this.http.post(`${this.apiUrl}-list`,e)}getCategory(e){return this.http.get(`${this.apiUrl}/${e}`)}createCategory(e){return this.http.post(this.apiUrl,e)}updateCategory(e,n){return this.http.put(`${this.apiUrl}/${e}`,n)}deleteCategory(e){return this.http.delete(`${this.apiUrl}/${e}`)}deleteUser(e,n){return this.http.delete(`${this.apiUrl}/${e}/users/${n}`)}static \u0275fac=function(n){return new(n||i)(t.KVO(b.Qq))};static \u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var m=l(837),c=l(9417),f=l(4550),_=l(4058);const C=["formModal"],x=["noticeSwal"],k=i=>["/apps/categories",i],F=i=>({"ki-up":i});function S(i,r){if(1&i&&(t.qex(0),t.j41(1,"div",26),t.nrm(2,"span",27),t.EFF(3),t.nI1(4,"titlecase"),t.k0s(),t.bVm()),2&i){const e=r.$implicit;t.R7$(3),t.SpI("",t.bMT(4,1,e.name)," ")}}function j(i,r){if(1&i&&(t.j41(0,"div",26),t.nrm(1,"span",27),t.j41(2,"em"),t.EFF(3),t.k0s()()),2&i){const e=t.XpG().$implicit;t.R7$(3),t.SpI(" ",0===e.permissions.length?"No permissions given...":"and "+(e.permissions.length-5)+" more..."," ")}}function w(i,r){if(1&i&&(t.qex(0),t.j41(1,"div",15)(2,"div",16)(3,"div",17)(4,"div",18)(5,"h2"),t.EFF(6),t.nI1(7,"titlecase"),t.k0s()()(),t.j41(8,"div",19)(9,"div",20),t.EFF(10),t.k0s(),t.j41(11,"div",21),t.DNE(12,S,5,3,"ng-container",14)(13,j,4,1,"div",22),t.k0s()(),t.j41(14,"div",23)(15,"a",24),t.EFF(16,"View Category"),t.k0s(),t.j41(17,"button",25),t.EFF(18,"Edit Category"),t.k0s()()()(),t.bVm()),2&i){const e=r.$implicit;t.R7$(6),t.JRh(t.bMT(7,6,e.name)),t.R7$(4),t.SpI("Total users with this category: ",e.users.length,""),t.R7$(2),t.Y8G("ngForOf",e.permissions.slice(0,5)),t.R7$(),t.Y8G("ngIf",e.permissions.length>5||0===e.permissions.length),t.R7$(2),t.Y8G("routerLink",t.eq3(8,k,e.id)),t.R7$(2),t.BMQ("data-id",e.id)}}function I(i,r){if(1&i&&(t.qex(0),t.DNE(1,w,19,10,"ng-container",14),t.bVm()),2&i){const e=r.ngIf;t.R7$(),t.Y8G("ngForOf",e.data)}}function E(i,r){1&i&&(t.j41(0,"div"),t.EFF(1,"Category name is required"),t.k0s())}function M(i,r){1&i&&(t.j41(0,"div"),t.EFF(1,"Category name must be at least 4 characters long"),t.k0s())}function T(i,r){if(1&i&&(t.j41(0,"div",48),t.DNE(1,E,2,0,"div",6)(2,M,2,0,"div",6),t.k0s()),2&i){t.XpG();const e=t.sdS(18);t.R7$(),t.Y8G("ngIf",null==e.errors?null:e.errors.required),t.R7$(),t.Y8G("ngIf",null==e.errors?null:e.errors.minlength)}}function R(i,r){if(1&i){const e=t.RV6();t.j41(0,"form",28,2),t.bIt("ngSubmit",function(a){t.eBV(e);const o=t.sdS(1),s=t.XpG();return t.Njj(s.onSubmit(a,o))}),t.j41(2,"div",29)(3,"h4",30),t.EFF(4,"Category Details"),t.k0s(),t.j41(5,"button",31),t.bIt("click",function(){const a=t.eBV(e).$implicit;return t.Njj(a.dismiss("Cross click"))}),t.k0s()(),t.j41(6,"div",32)(7,"div",33)(8,"div",34),t.bIt("click",function(){t.eBV(e);const a=t.sdS(13);return t.Njj(a.toggle())}),t.EFF(9,"User Information "),t.j41(10,"span",35),t.nrm(11,"i",36),t.k0s()(),t.j41(12,"div",37,3),t.mxI("ngbCollapseChange",function(a){t.eBV(e);const o=t.XpG();return t.DH7(o.isCollapsed1,a)||(o.isCollapsed1=a),t.Njj(a)}),t.j41(14,"div",38)(15,"label",39),t.EFF(16,"Category Name"),t.k0s(),t.j41(17,"input",40,4),t.mxI("ngModelChange",function(a){t.eBV(e);const o=t.XpG();return t.DH7(o.categoryModel.name,a)||(o.categoryModel.name=a),t.Njj(a)}),t.k0s(),t.DNE(19,T,3,2,"div",41),t.k0s()()()(),t.j41(20,"div",42)(21,"button",43),t.bIt("click",function(){const a=t.eBV(e).$implicit;return t.Njj(a.dismiss("cancel"))}),t.EFF(22," Discard "),t.k0s(),t.j41(23,"button",44)(24,"span",45),t.EFF(25," Submit "),t.k0s(),t.j41(26,"span",46),t.EFF(27," Please wait... "),t.nrm(28,"span",47),t.k0s()()()()}if(2&i){const e=t.sdS(1),n=t.XpG();t.R7$(8),t.BMQ("aria-expanded",!n.isCollapsed1),t.R7$(3),t.Y8G("ngClass",t.eq3(6,F,!n.isCollapsed1)),t.R7$(),t.R50("ngbCollapse",n.isCollapsed1),t.R7$(5),t.R50("ngModel",n.categoryModel.name),t.R7$(2),t.Y8G("ngIf",e.submitted&&e.invalid),t.R7$(4),t.BMQ("data-kt-indicator",n.isLoading?"on":"off")}}let G=(()=>{class i{apiService;cdr;renderer;modalService;isCollapsed1=!1;isLoading=!1;categories$;reloadEvent=new t.bkB;category$;categoryModel={id:0,name:"",permissions:[],users:[]};formModal;noticeSwal;swalOptions={};modalConfig={modalDialogClass:"modal-dialog modal-dialog-centered mw-650px"};clickListener;constructor(e,n,a,o){this.apiService=e,this.cdr=n,this.renderer=a,this.modalService=o}ngAfterViewInit(){this.clickListener=this.renderer.listen(document,"click",e=>{const n=e.target.closest(".btn");if(n){const{action:a,id:o}=n.dataset;switch(a){case"view":case"delete":break;case"create":this.create(),this.modalService.open(this.formModal,this.modalConfig);break;case"edit":this.edit(o),this.modalService.open(this.formModal,this.modalConfig)}}})}ngOnInit(){this.categories$=this.apiService.getCategories()}delete(e){this.apiService.deleteCategory(e).subscribe(()=>{})}edit(e){this.category$=this.apiService.getCategory(e),this.category$.subscribe(n=>{this.categoryModel=n})}create(){this.categoryModel={id:0,name:"",permissions:[],users:[]}}onSubmit(e,n){if(n&&n.invalid)return;this.isLoading=!0;const a={icon:"success",title:"Success!",text:this.categoryModel.id>0?"User updated successfully!":"User created successfully!"},o={icon:"error",title:"Error!",text:""},s=()=>{this.isLoading=!1,this.modalService.dismissAll(),this.categories$=this.apiService.getCategories(),this.cdr.detectChanges()};this.categoryModel.id>0?(()=>{this.apiService.updateCategory(this.categoryModel.id,this.categoryModel).subscribe({next:()=>{this.showAlert(a),this.reloadEvent.emit(!0)},error:u=>{o.text=this.extractText(u.error),this.showAlert(o),this.isLoading=!1},complete:s})})():(()=>{this.apiService.createCategory(this.categoryModel).subscribe({next:()=>{this.showAlert(a),this.reloadEvent.emit(!0)},error:u=>{o.text=this.extractText(u.error),this.showAlert(o),this.isLoading=!1},complete:s})})()}extractText(e){var n=[];for(var a in e)"string"==typeof e[a]?n.push(e[a]):"object"==typeof e[a]&&(n=n.concat(this.extractText(e[a])));return Array.from(new Set(n)).join("\n")}showAlert(e){let n=e.icon?.toString()||"success";"error"===e.icon&&(n="danger"),this.swalOptions=Object.assign({buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn btn-"+n}},e),this.cdr.detectChanges(),this.noticeSwal.fire()}ngOnDestroy(){this.clickListener&&this.clickListener(),this.modalService.dismissAll()}static \u0275fac=function(n){return new(n||i)(t.rXU(y),t.rXU(t.gRc),t.rXU(t.sFG),t.rXU(m.Bq))};static \u0275cmp=t.VBU({type:i,selectors:[["app-category-listing"]],viewQuery:function(n,a){if(1&n&&(t.GBs(C,5),t.GBs(x,5)),2&n){let o;t.mGM(o=t.lsd())&&(a.formModal=o.first),t.mGM(o=t.lsd())&&(a.noticeSwal=o.first)}},decls:14,vars:4,consts:[["noticeSwal",""],["formModal",""],["myForm","ngForm"],["collapse1","ngbCollapse"],["name","ngModel"],[1,"row","row-cols-1","row-cols-md-2","row-cols-xl-3","g-5","g-xl-9"],[4,"ngIf"],[1,"ol-md-4"],[1,"card","h-md-100"],[1,"card-body","d-flex","flex-center"],["type","button","data-action","create",1,"btn","btn-clear","d-flex","flex-column","flex-center"],["src","assets/media/illustrations/sketchy-1/4.png","alt","",1,"mw-100","mh-150px","mb-7"],[1,"fw-bold","fs-3","text-gray-600","text-hover-primary"],[3,"swalOptions"],[4,"ngFor","ngForOf"],[1,"col-md-4"],[1,"card","card-flush","h-md-100"],[1,"card-header"],[1,"card-title"],[1,"card-body","pt-1"],[1,"fw-bold","text-gray-600","mb-5"],[1,"d-flex","flex-column","text-gray-600"],["class","d-flex align-items-center py-2",4,"ngIf"],[1,"card-footer","flex-wrap","pt-0"],[1,"btn","btn-light","btn-active-primary","my-1","me-2",3,"routerLink"],["type","button","data-action","edit",1,"btn","btn-light","btn-active-light-primary","my-1"],[1,"d-flex","align-items-center","py-2"],[1,"bullet","bg-primary","me-3"],[3,"ngSubmit"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["id","kt_modal_update_customer_scroll","data-kt-scroll","true","data-kt-scroll-activate","{default: false, lg: true}","data-kt-scroll-max-height","auto","data-kt-scroll-dependencies","#kt_modal_update_customer_header","data-kt-scroll-wrappers","#kt_modal_update_customer_scroll","data-kt-scroll-offset","300px",1,"d-flex","flex-column","scroll-y","me-n7","pe-7","mw-650px"],["data-bs-toggle","collapse","category","button","aria-controls","kt_modal_update_customer_user_info",1,"fw-bold","fs-3","rotate","collapsible","mb-7",3,"click"],[1,"ms-2","rotate-180"],[1,"ki-duotone","ki-down","fs-3",3,"ngClass"],[1,"collapse","show",3,"ngbCollapseChange","ngbCollapse"],[1,"fv-row","mb-7"],[1,"required","fw-semibold","fs-6","mb-2"],["type","text","name","name","required","","minlength","4",1,"form-control","form-control-solid",3,"ngModelChange","ngModel"],["class","fv-plugins-message-container fv-plugins-message-container--enabled invalid-feedback",4,"ngIf"],[1,"modal-footer","flex-center"],["type","reset","id","kt_modal_update_customer_cancel",1,"btn","btn-light","me-3",3,"click"],["type","submit","id","kt_modal_update_customer_submit",1,"btn","btn-primary"],[1,"indicator-label"],[1,"indicator-progress"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"],[1,"fv-plugins-message-container","fv-plugins-message-container--enabled","invalid-feedback"]],template:function(n,a){1&n&&(t.j41(0,"div",5),t.DNE(1,I,2,1,"ng-container",6),t.nI1(2,"async"),t.j41(3,"div",7)(4,"div",8)(5,"div",9)(6,"button",10),t.nrm(7,"img",11),t.j41(8,"div",12),t.EFF(9,"Add New Category"),t.k0s()()()()()(),t.nrm(10,"swal",13,0),t.DNE(12,R,29,8,"ng-template",null,1,t.C5r)),2&n&&(t.R7$(),t.Y8G("ngIf",t.bMT(2,2,a.categories$)),t.R7$(9),t.Y8G("swalOptions",a.swalOptions))},dependencies:[d.YU,d.Sq,d.bT,c.qT,c.me,c.BC,c.cb,c.YS,c.xh,c.vS,c.cV,f.Wk,m.$G,_.b7,d.Jj,d.PV]})}return i})();var L=l(7586),v=l.n(L),D=l(4084);function U(i,r){if(1&i&&(t.j41(0,"div",19),t.nrm(1,"span",20),t.EFF(2),t.k0s()),2&i){const e=t.XpG().$implicit;t.R7$(2),t.SpI(" ",e.name," ")}}function N(i,r){if(1&i&&(t.j41(0,"div",19),t.nrm(1,"span",20),t.j41(2,"em"),t.EFF(3),t.k0s()()),2&i){const e=t.XpG(2).ngIf;t.R7$(3),t.SpI("and ",e.permissions.length-5," more...")}}function Y(i,r){if(1&i&&(t.qex(0),t.DNE(1,U,3,1,"div",18)(2,N,4,1,"div",18),t.bVm()),2&i){const e=r.index,n=t.XpG().ngIf;t.R7$(),t.Y8G("ngIf",e<5),t.R7$(),t.Y8G("ngIf",5===e&&(null==n.permissions?null:n.permissions.length)&&n.permissions.length>5)}}function B(i,r){if(1&i&&(t.qex(0),t.DNE(1,Y,3,2,"ng-container",17),t.bVm()),2&i){const e=r.ngIf;t.R7$(),t.Y8G("ngForOf",e.permissions)}}function V(i,r){if(1&i&&(t.qex(0),t.j41(1,"span",21),t.EFF(2),t.k0s(),t.bVm()),2&i){const e=r.ngIf;t.R7$(2),t.SpI("(",e.users.length,")")}}let X=(()=>{class i{route;apiService;category$;datatableConfig={};reloadEvent=new t.bkB;constructor(e,n){this.route=e,this.apiService=n}ngOnInit(){this.route.params.subscribe(e=>{const n=e.id;this.category$=this.apiService.getCategory(n),this.datatableConfig={serverSide:!0,ajax:(a,o)=>{this.apiService.getUsers(n,a).subscribe(s=>{console.log(s),o(s)})},columns:[{title:"Name",data:"name",render:function(a,o,s){const g=["success","info","warning","danger"],p=g[Math.floor(Math.random()*g.length)],u=a[0].toUpperCase();return`\n              <div class="symbol symbol-circle symbol-50px overflow-hidden me-3" data-action="view" data-id="${s.id}">\n                <a href="javascript:;">\n                  \n              <div class="symbol-label fs-3 bg-light-${p} text-${p}">\n                ${u}\n              </div>\n            \n                </a>\n              </div>\n              \n              <div class="d-flex flex-column" data-action="view" data-id="${s.id}">\n                <a href="javascript:;" class="text-gray-800 text-hover-primary mb-1">${a}</a>\n                <span>${s.email}</span>\n              </div>\n            \n            `}},{title:"Category",data:"category",render:function(a,o,s){return s.categories[0]?.name||""},orderData:[1],orderSequence:["asc","desc"],type:"string"},{title:"Last Login",data:"last_login_at",render:(a,o,s)=>{const g=a||s.created_at;return`<div class="badge badge-light fw-bold">${v()(g).fromNow()}</div>`}},{title:"Joined Date",data:"created_at",render:function(a){return v()(a).format("DD MMM YYYY, hh:mm a")}}],createdRow:function(a,o,s){$("td:eq(0)",a).addClass("d-flex align-items-center")}}})}deleteUser(e){this.route.params.subscribe(n=>{this.apiService.deleteUser(n.id,e).subscribe(()=>{this.reloadEvent.emit(!0)})})}static \u0275fac=function(n){return new(n||i)(t.rXU(f.nX),t.rXU(y))};static \u0275cmp=t.VBU({type:i,selectors:[["app-category-details"]],decls:26,vars:11,consts:[[1,"d-flex","flex-column","flex-lg-row"],[1,"flex-column","flex-lg-row-auto","w-100","w-lg-200px","w-xl-300px","mb-10"],[1,"card","card-flush"],[1,"card-header"],[1,"card-title"],[1,"mb-0"],[1,"card-body","pt-0"],[1,"d-flex","flex-column","text-gray-600"],[4,"ngIf"],[1,"card-footer","pt-0"],["type","button","data-category-id","developer","data-bs-toggle","modal","data-bs-target","#kt_modal_update_category",1,"btn","btn-light","btn-active-primary"],[1,"flex-lg-row-fluid","ms-lg-10"],[1,"card","card-flush","mb-6","mb-xl-9"],[1,"card-header","pt-5"],[1,"d-flex","align-items-center"],[1,"card-toolbar"],[3,"deleteEvent","datatableConfig","reload"],[4,"ngFor","ngForOf"],["class","d-flex align-items-center py-2",4,"ngIf"],[1,"d-flex","align-items-center","py-2"],[1,"bullet","bg-primary","me-3"],[1,"text-gray-600","fs-6","ms-1"]],template:function(n,a){if(1&n&&(t.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"h2",5),t.EFF(6),t.nI1(7,"async"),t.k0s()()(),t.j41(8,"div",6)(9,"div",7),t.DNE(10,B,2,1,"ng-container",8),t.nI1(11,"async"),t.k0s()(),t.j41(12,"div",9)(13,"button",10),t.EFF(14,"Edit Category"),t.k0s()()()(),t.j41(15,"div",11)(16,"div",12)(17,"div",13)(18,"div",4)(19,"h2",14),t.EFF(20,"Users Assigned "),t.DNE(21,V,3,1,"ng-container",8),t.nI1(22,"async"),t.k0s()(),t.nrm(23,"div",15),t.k0s(),t.j41(24,"div",6)(25,"app-crud",16),t.bIt("deleteEvent",function(s){return a.deleteUser(s)}),t.k0s()()()()()),2&n){let o;t.R7$(6),t.SpI(" ",null==(o=t.bMT(7,5,a.category$))?null:o.name," "),t.R7$(4),t.Y8G("ngIf",t.bMT(11,7,a.category$)),t.R7$(11),t.Y8G("ngIf",t.bMT(22,9,a.category$)),t.R7$(4),t.Y8G("datatableConfig",a.datatableConfig)("reload",a.reloadEvent)}},dependencies:[d.Sq,d.bT,D.i,d.Jj]})}return i})();var A=l(7470),O=l(691);let q=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=t.$C({type:i});static \u0275inj=t.G2t({imports:[d.MD,c.YN,c.X1,f.iI.forChild([{path:"",component:G},{path:":id",component:X}]),O.B,A.G,m.Pv,m.zH,m.HC,m.n8,_.RZ.forChild()]})}return i})()}}]);